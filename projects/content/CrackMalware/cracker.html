<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>RANSOMEWARE RESCUE| Devangshu Mazumder</title>
    
    <!-- Main Style -->
    <link rel="stylesheet" href="/projects/content/VideoFuzz/style.css">

    <!-- Favicon -->
    <link id="favicon" rel="shortcut icon" href="/assets/images/profile6.png" type="image/x-png">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>

    <!-- Navbar Section -->
    <header>
        <a href="/" class="logo"><i class="fas fa-shield-alt"></i> Devangshu</a>
        <div id="menu" class="fas fa-bars"></div>
        <nav class="navbar">
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#skills">Skills</a></li>
                <li><a href="/projects">Projects</a></li>
                <li><a href="#experience">Experience</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>

   <!-- Project Section -->
<section class="project-description">
    <canvas id="matrixCanvas"></canvas>
    <h1 class="animate-title">CRACKING THE CODE: HOW I DEFEATED RANSOMWARE TO RESCUE HANK'S FILES</h1>
    
    <h4 class="animate-title">Introduction: The Challenge of Ransomware</h4>
    <br>

    <!-- Project Overview -->
    <div class="project-details">
        <h2 class="animate-title">Introduction</h2>
        <p class="animate-desc">Imagine this: Your personal files—years of photos, documents, and memories—are suddenly locked away, held hostage by a piece of malicious ransomware. That’s exactly what happened to my friend Hank. His files had been encrypted, and unless we could find the key, they were lost for good.</p>

        <p class="animate-desc">But Hank had one thing on his side: Me. As a cybersecurity professional, I was determined to break down the malware that had taken over his files, recover the encryption key, and restore his data.</p>

        <!-- Video 1: Displaying Encrypted Files -->
        <div class="media animate-media">
            <iframe src="https://www.youtube.com/embed/ukQ6tfWkTSc?si=gSu6rq-9ruSOnk4z"" width="640" height="480" frameborder="0" allowfullscreen></iframe>
            <p2 class="animate-desc">Video 1: Displaying Encrypted Files in Hank's Backup</p2>
        </div>

        <p class="animate-desc">In this video, you can see the damage. Hank’s files are in his backup folder, but they’ve all been renamed and encrypted by the ransomware. The stakes were clear: I had to reverse-engineer the malware and decrypt these files.</p>

        <h2 class="animate-title">Malware Analysis: Dissecting the Threat</h2>
        <p class="animate-desc">To understand how the ransomware operated, I turned to one of the most powerful reverse-engineering tools available: Ghidra. By loading the malware into Ghidra, I could examine its internal code and see how it was targeting Hank's files.</p>

        <h2 class="animate-title">Uncovering the Attack Code</h2>
        <p class="animate-desc">The malware, named mYSCpPoHAih, was designed to target files in specific directories and rename them with the ~en prefix, indicating that they had been encrypted. This attack was the first clue that the encryption process was happening at the system level, so I started diving deeper into the code.</p>
        
        <!-- Image 1: Attack Code Analysis -->
        <div class="media animate-media">
            <img src="/assets/images/projects/attack_code.png" alt="Attack Code Analysis" class="project-image">
            <p2 class="animate-desc">Figure 1: Attack Code Analysis</p2>
        </div>
        <p class="animate-desc">By analyzing the attack code, I was able to trace the function calls that listed the files, renamed them, and eventually passed them to the encryption routine. This was where the real magic—or in this case, destruction—happened.</p>
        
        <h2 class="animate-title">Reverse Engineering the Encryption</h2>
        <p class="animate-desc">In the process of reverse engineering, I found the encryption function buried deep within the code. The ransomware was using AES in CBC mode (Cipher Block Chaining) to encrypt each file. Understanding this was critical because CBC mode requires two key components: the Initialization Vector (IV) and the encryption key.</p>

        <!-- Image 2: Encryption Function in Ghidra -->
        <div class="media animate-media">
            <img src="/assets/images/projects/encryption_function.png" alt="Encryption Function" class="project-image">
            <p2 class="animate-desc">Figure 2: Encryption Function in Ghidra</p2>
        </div>

        <p class="animate-desc">The encryption process started by opening the plaintext file, creating a destination file (the encrypted version), and then allocating a buffer size for the encryption process. But the key insight came when I discovered where the IV and key were being stored.</p>
        
        <h2 class="animate-title">Locating the IV and Key</h2>
        <p class="animate-desc">By following the code closely, I found the hardcoded values for both the IV and the key:</p>
        <ul class="animate-desc">
            <li><strong>IV Location:</strong> DAT_140086010</li>
            <li><strong>Key Location:</strong> DAT_140086000</li>
            <li><strong>IV:</strong> b'\x0a\x0b\x0c\x0d\x0e\x0f\xa0\xb0\xc0\xd0\xe0\xf0\xaa\xbb\xcc\xdd'</li>
            <li><strong>Key:</strong> b'\x8d\x02\xe6\x5e\x50\x83\x08\xdd\x74\x3f\x0d\xd4\xd3\x1e\x48\x4d'</li>
        </ul>

        <!-- Image 3: IV Location in Ghidra -->
        <div class="media animate-media">
            <img src="/assets/images/projects/IV.png" alt="IV Location" class="project-image">
            <p2 class="animate-desc">Figure 3: IV Location in Ghidra</p2>
        </div>

        <h2 class="animate-title">Crafting the Decryption Tool: Breaking the Cipher</h2>
        <p class="animate-desc">With the IV and key now in hand, I got to work coding a decryption tool using Python. I chose the PyCryptodome library, which provides robust cryptographic functions, and built a script to decrypt Hank’s files block by block.</p>

        <!-- Video 2: Decryption Script Execution -->
        <div class="media animate-media">
            <iframe src="https://www.youtube.com/embed/gFgiohWacgI?si=YfewP-YUN3cDF4FK" width="640" height="480" frameborder="0" allowfullscreen></iframe>
            <p2 class="animate-desc">Video 2: Decryption Script Execution</p2>
        </div>
        <p class="animate-desc">In this video, you’ll see my Python script running in real-time. The tool reads each encrypted file, removes the 16-byte IV and 4-byte file size prefix, and then decrypts the remaining data using AES in CBC mode. I also added a progress bar so that the decryption process could be monitored in real-time.</p>

        <h2 class="animate-title">Victory: Recovering Hank's Files</h2>
        <p class="animate-desc">After running the decryption tool, Hank’s files were fully restored. The decryption process worked flawlessly, and his data was safe once more.</p>

        <!-- Video 3: Decrypted Files in Hank's Backup -->
        <div class="media animate-media">
            <iframe src="https://www.youtube.com/embed/PenBRWVDbzQ?si=0hWkDpPPfEcmqiJG" width="640" height="480" frameborder="0" allowfullscreen></iframe>
            <p2 class="animate-desc">Video 3: Decrypted Files in Hank's Backup</p2>
        </div>

        <h2 class="animate-title">Technical Breakdown: Tools & Process</h2>
        <ul class="animate-desc">
            <li>Ghidra: To reverse-engineer the ransomware and extract the key and IV from memory locations.</li>
            <li>Python & PyCryptodome: To implement the decryption algorithm using AES in CBC mode.</li>
            <li>MacBook Pro (2017, Intel): The machine used for both reverse engineering and development.</li>
            <li>Virtual Environment: Isolated environment to manage dependencies safely without affecting system-wide configurations.</li>
        </ul>

        <h2 class="animate-title">Lessons Learned & Final Thoughts</h2>
        <p class="animate-desc">This project not only reinforced my expertise in reverse engineering and cryptography, but also showcased my problem-solving abilities under pressure. I took a dangerous ransomware, dissected its encryption method, and successfully built a custom decryption tool. Hank’s files were saved, and I gained invaluable experience.</p>

        <h2 class="animate-title">Ready to Discuss More?</h2>
        <p class="animate-desc">If you're looking for someone who can tackle real-world cybersecurity threats, reverse-engineer malware, and develop solutions that work, let's connect! I’m ready to bring these skills to your organization and tackle the next big challenge in cybersecurity.</p>
    </div>

    <!-- Tools & Technologies Used -->
    <h3 class="animate-title">Tools & Technologies</h3>
    <ul class="animate-desc">
        <li>Ghidra</li>
        <li>Python & PyCryptodome</li>
        <li>MacBook Pro (2017)</li>
        <li>Virtual Environment</li>
    </ul>

   <!-- GitHub Button Section -->
   <div class="cta animate-cta">
    <a href="https://github.com/DevDevangshu404/Ransomeware-Decryption-Tool" target="_blank" class="btn github-btn">View on GitHub</a>
   <br>
    <!-- Call to Action (e.g., View More Projects or Go Back to Projects Page) -->
    <div class="cta animate-cta">
        <a href="/projects" class="btn">Back to Projects</a>
    </div>
</section>

<!-- Matrix Effect Script (same as before) -->
<script>
    const canvas = document.getElementById('matrixCanvas');
    const ctx = canvas.getContext('2d');
    let matrixChars = '01'; 
    const fontSize = 18;
    let columns;
    let drops;

    function adjustCanvasSize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        columns = Math.floor(canvas.width / fontSize);
        drops = Array(columns).fill(0);
    }

    function drawMatrix() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#7e3079'; 
        ctx.font = `${fontSize}px monospace`;

        for (let i = 0; i < drops.length; i++) {
            const text = matrixChars[Math.floor(Math.random() * matrixChars.length)];
            ctx.fillText(text, i * fontSize, drops[i] * fontSize);

            if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                drops[i] = 0;
            }
            drops[i]++;
        }
    }

    setInterval(drawMatrix, 33);

    window.addEventListener('resize', adjustCanvasSize);
    adjustCanvasSize();
</script>



       
    

    <!-- Footer Section -->
    <footer>
        <div class="footer-content">
            <h3>Devangshu Mazumder</h3>
            <p>Thank you for visiting my portfolio. Let's connect on social media or via email to collaborate on interesting projects.</p>
            <div class="socials">
                <a href="https://linkedin.com/in/devangshumazumder" target="_blank"><i class="fab fa-linkedin"></i></a>
                <a href="https://github.com/DevDevangshu404" target="_blank"><i class="fab fa-github"></i></a>
                <a href="mailto:devangshuwork@gmail.com"><i class="fas fa-envelope"></i></a>
            </div>
        </div>
    </footer>

<!-- scroll top btn -->
<a href="#work" class="fas fa-angle-up" id="scroll-top"></a>

<!-- ==== ALL MAJOR JAVASCRIPT CDNS STARTS ==== -->
<!-- jquery cdn -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<!-- vanilla tilt.js links -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/vanilla-tilt/1.7.0/vanilla-tilt.min.js"></script>

<!-- scroll reveal anim -->
<script src="https://unpkg.com/scrollreveal"></script>

<!-- isotope filter plugin cdn -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js"></script>

<!-- ==== ALL MAJOR JAVASCRIPT CDNS ENDS ==== -->

<!-- Custom JS -->
<script src="./script.js"></script>
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>


</body>
</html>